<view class="page">
  <view class="page__bd" style='margin-bottom:150rpx'>
    <view wx:for="{{dynamics}}" wx:key="*this" wx:for-item="item">
      <view class="weui-panel weui-panel_access d1" style="padding:30rpx;margin-top:1rpx">
        <view class="weui-panel__bd d1">
          <view class="weui-media-box weui-media-box_appmsg d1"  style="padding:0">
            <view class="weui-media-box__hd weui-media-box__hd_in-appmsg d1">
              <image class="weui-media-box__thumb d1" src="{{item.creatorAvatar}}"/>
            </view>
            <view class="weui-media-box__title weui-media-box__title_in-text d1"  style="margin-bottom:0">
              <view class="weui-media-box__title text-size-14 d1">{{item.creatorName}}</view>
              <view class="weui-media-box__info text-size-12 d1" style="color:#999">{{item.timeStr}}</view>
            </view>
          </view>
        </view>
        <view class="weui-panel__ft text-size-14 d1">
          <view class="weui-cell__bd" style="padding-bottom:10rpx" wx:show="{{item.content.length > 0}}">
          {{item.content}}</view>
          <view class="weui-cell__bd" wx:show="{{item.attach.length > 0}}">
            <view class="weui-uploader">
              <view class="weui-uploader__bd">
                <view class="weui-uploader__files" id="uploaderFiles">
                  <block wx:for="{{item.attach}}" wx:key="*this" wx:for-item="pic">
                    <view class="weui-uploader__file" bindtap="previewImage" id="{{pic}}" data-urls="{{item.attach}}">
                      <image class="weui-uploader__img" src="{{pic}}" mode="aspectFill" style="display:block;width:{{imageWidth}};height:{{imageWidth}}"/>
                    </view>
                  </block>
                </view>
              </view>
            </view>
          </view>
          <view class="weui-flex" style="background:#fff">
            <view class="weui-flex__item">
              <view class="weui-grid__label" style="color:#2C7AD6;text-align:left" wx:if="{{item.groupId}}"
                bindtap="gotoTeam" id="{{item.groupId}}">{{"#"+item.groupName+"# "}}
              </view>
              <view class="weui-grid__label" style="color:#2C7AD6;text-align:left" wx:if="{{item.relates.length>0}}"
                wx:for="{{item.relates}}" wx:for-item="game" bindtap="gotoGame" id="{{game.relateId}}"
                wx:key="*this">{{"#"+game.relateName+"# "}}
              </view>
            </view>
            <view class="weui-flex__item" wx:if="{{item.creatorId == userId}}">
              <view class="weui-grid__label" style="color:#2C7AD6;text-align:right" id="{{item.id}}"
                bindtap="deleteDyna">删除</view>
            </view>
          </view>
          <view class="weui-panel__ft text-size-13 d1" wx:show="{{item.replyPosts.length > 0}}">
            <view class="weui-cell__bd re" wx:for="{{item.replyPosts}}" wx:key="*this" wx:for-item="reply"
              id="{{item.id}}" data-reply-Id="{{reply.replyPostId}}" data-uid="{{item.creatorId}}" 
              catchtap="pressReply">
              <view catchtap="gotoPer" class="text-size-13 text-blue reply" id="{{reply.creatorId}}">
                {{reply.creatorName}}
              </view>
              <view wx:if="{{reply.beReplyPostCreatorId}}" class="text-size-13 reply">回复</view>
              <view wx:if="{{reply.beReplyPostCreatorId}}" class="text-size-13 text-blue reply" 
                catchtap="gotoPer" id="{{reply.beReplyPostCreatorId}}">
                {{reply.beReplyPostCreatorName}}
              </view>
              <view class="text-size-13 reply">{{"："+reply.content}}</view>
            </view>
          </view>
          <view class="weui-flex" style="background:#fff;padding-top:20rpx">
            <!-- <view class="weui-flex__item">
              <view class="weui-grid__label" style="color:#999">打赏</view>
            </view> -->
            <view class="weui-flex__item">
              <view class="weui-grid__label" style="color:#999" id="{{item.id}}"
                data-uid="{{item.creatorId}}" catchtap="pressReply">
              {{item.commentNumber ? "评论("+item.commentNumber+")" : "评论"}}
              </view>
            </view>
            <view class="weui-flex__item">
              <view class="weui-grid__label" style="color:#66CC99" wx:if="{{item.voted}}" 
                catchtap="userVote" id="{{item.id}}" data-voted="false">
              {{item.likerNumber ? "点赞("+item.likerNumber+")" : "点赞"}}
              </view>
              <view class="weui-grid__label" style="color:#999" wx:else catchtap="userVote"
                id="{{item.id}}" data-voted="true">
              {{item.likerNumber ? "点赞("+item.likerNumber+")" : "点赞"}}
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
  <view class="popup-example--bottom zan-popup zan-popup--bottom {{ showReply ? 'zan-popup--show' : ''}}">
    <view class="zan-popup__mask" catchtap="toggleReply"></view>
    <view class="zan-popup__container">
      <view class="weui-cell weui-cell_input text-size-14">
        <view class="weui-cell__bd">
          <input class="weui-input" placeholder="请输入回复内容" bindconfirm="createReply"/>
        </view>
      </view>
    </view>
  </view>
  <view class="popup-example--bottom zan-popup zan-popup--bottom {{ showDelete ? 'zan-popup--show' : ''}}">
    <view class="zan-popup__mask" catchtap="toggleDelete"></view>
    <view class="zan-popup__container">
      <view class="weui-cells weui-cells_after-title text-size-14">
        <view class="weui-cell weui-cell_access" id="1" bindtap="deleteChange">
          <view class="weui-cell__bd weui-cell_primary" style="text-align:center;padding:20rpx;color:#EB3941">
            删除
          </view>
        </view>
        <view class="weui-cell weui-cell_access" id="2" bindtap="deleteChange">
          <view class="weui-cell__bd weui-cell_primary" style="text-align:center;padding:20rpx">取消</view>
        </view>
      </view>
    </view>
  </view>
  <button class="weui-btn send" bindtap="gotoPost">
    <image src="../../../images/icon_photo.png" style="width:24px;height:24px;margin-right:10rpx"/>发动态
  </button>
</view>